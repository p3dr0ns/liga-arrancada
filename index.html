<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Arrancada</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #121212;
            color: #e0e0e0;
            padding: 20px;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        table {
            width: 100%;
            margin-bottom: 20px;
            border-collapse: collapse;
            background-color: #333;
            border-radius: 10px;
            overflow: hidden;
        }
        th, td {
            padding: 12px;
            text-align: center;
            border: 1px solid #555;
        }
        th {
            background-color: #444;
            color: #fff;
        }
        td {
            background-color: #2c2c2c;
            color: #fff;
        }
        button {
            padding: 12px 20px;
            font-size: 16px;
            cursor: pointer;
            margin: 5px;
            border: none;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        button:hover {
            opacity: 0.8;
        }
        .vitoria {
            background-color: #4CAF50;
            color: white;
        }
        .wo {
            background-color: #FF9800;
            color: white;
        }
        .add-remove {
            background-color: #2196F3;
            color: white;
        }
        .backup {
            background-color: #FFC107;
            color: white;
        }
        .sortear {
            background-color: #9C27B0;
            color: white;
        }
        .diminuir {
            background-color: #F44336;
            color: white;
        }
        .actions {
            margin-top: 30px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            width: 100%;
        }
        .actions button {
            width: 180px;
            margin: 10px;
        }
        h1 {
            color: #fff;
            margin-bottom: 20px;
            font-size: 2em;
        }
        #tabela-corpo {
            max-height: 500px;
            overflow-y: auto;
        }
        .tabela-container {
            overflow-x: auto;
            width: 100%;
        }
        /* Responsividade para dispositivos móveis */
        @media (max-width: 768px) {
            .actions {
                flex-direction: column;
                align-items: center;
            }
            .actions button {
                width: 100%;
                margin: 5px 0;
            }
            table {
                width: 100%;
                margin-top: 10px;
            }
            h1 {
                font-size: 1.5em;
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>

    <h1>Lista de Arrancada</h1>

    <div class="tabela-container">
        <table id="tabela">
            <thead>
                <tr>
                    <th>Carro</th>
                    <th>Pontos</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody id="tabela-corpo">
                <!-- Os pilotos serão carregados aqui -->
            </tbody>
        </table>
    </div>

    <div class="actions">
        <button class="add-remove" onclick="adicionarPiloto()">Adicionar Piloto</button>
        <button class="add-remove" onclick="removerPiloto()">Remover Piloto</button>
        <button class="backup" onclick="exportarBackup()">Exportar Backup</button>
        <input type="file" id="importar-backup" onchange="importarBackup(event)" style="display:none">
        <button class="backup" onclick="document.getElementById('importar-backup').click()">Importar Backup</button>
        <button class="sortear" onclick="sortearCorridas()">Sortear Corridas</button>
    </div>

    <script>
        let pilotoCount = 0;
        let pilotos = [];

        // Carregar pilotos do localStorage
        window.onload = function() {
            const dadosSalvos = localStorage.getItem('pilotos');
            if (dadosSalvos) {
                pilotos = JSON.parse(dadosSalvos);
            } else {
                // Dados iniciais
                pilotos = [
                    { nome: 'Carro 1', pontos: 0 },
                    { nome: 'Carro 2', pontos: 0 }
                ];
            }
            atualizarTabela();
        };

        function atualizarPontos(carro, pontos) {
            const piloto = pilotos.find(p => p.nome === carro);
            if (piloto) {
                piloto.pontos += pontos;
                document.getElementById(`pontos-${carro}`).textContent = piloto.pontos;
                salvarDados();
            }
        }

        function diminuirPontos(carro) {
            const piloto = pilotos.find(p => p.nome === carro);
            if (piloto) {
                piloto.pontos = Math.max(0, piloto.pontos - 1); // Não deixa o ponto ser negativo
                document.getElementById(`pontos-${carro}`).textContent = piloto.pontos;
                salvarDados();
            }
        }

        function adicionarPiloto() {
            pilotoCount++;
            const nomePiloto = prompt("Digite o nome do novo piloto:");
            if (nomePiloto) {
                pilotos.push({ nome: nomePiloto, pontos: 0 });
                atualizarTabela();
                salvarDados();
            }
        }

        function removerPiloto() {
            const nomePiloto = prompt("Digite o nome do piloto a ser removido:");
            const index = pilotos.findIndex(p => p.nome === nomePiloto);
            if (index !== -1) {
                pilotos.splice(index, 1);
                atualizarTabela();
                salvarDados();
            } else {
                alert("Piloto não encontrado!");
            }
        }

        function atualizarTabela() {
            const corpoTabela = document.getElementById("tabela-corpo");
            corpoTabela.innerHTML = '';
            pilotos.forEach((piloto) => {
                const linha = document.createElement('tr');
                linha.innerHTML = `
                    <td>${piloto.nome}</td>
                    <td id="pontos-${piloto.nome}">${piloto.pontos}</td>
                    <td>
                        <button class="vitoria" onclick="atualizarPontos('${piloto.nome}', 2)">Vitória</button>
                        <button class="wo" onclick="atualizarPontos('${piloto.nome}', 1)">WO</button>
                        <button class="diminuir" onclick="diminuirPontos('${piloto.nome}')">Diminuir</button>
                    </td>
                `;
                corpoTabela.appendChild(linha);
            });
        }

        function exportarBackup() {
            const data = JSON.stringify(pilotos);
            const blob = new Blob([data], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'backup_arrancada.json';
            link.click();
        }

        function importarBackup(event) {
            const file = event.target.files[0];
            if (file && file.type === 'application/json') {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const dados = JSON.parse(e.target.result);
                        pilotos = dados;
                        atualizarTabela();
                        salvarDados();
                    } catch (error) {
                        alert("Erro ao importar o backup.");
                    }
                };
                reader.readAsText(file);
            } else {
                alert("Selecione um arquivo JSON válido.");
            }
        }

        function salvarDados() {
            localStorage.setItem('pilotos', JSON.stringify(pilotos));
        }

        function sortearCorridas() {
            const pilotosCopy = [...pilotos];
            if (pilotosCopy.length < 2) {
                alert("Não há pilotos suficientes para sortear corridas!");
                return;
            }

            const sorteados = [];
            while (pilotosCopy.length > 1) {
                const piloto1 = pilotosCopy.splice(Math.floor(Math.random() * pilotosCopy.length), 1)[0];
                const piloto2 = pilotosCopy.splice(Math.floor(Math.random() * pilotosCopy.length), 1)[0];
                sorteados.push([piloto1, piloto2]);
            }

            const sorteioWindow = window.open('', '', 'width=400,height=300');
            sorteioWindow.document.write('<h2>Corridas Sorteadas</h2>');
            sorteioWindow.document.write('<ul>');
            sorteados.forEach(pair => {
                sorteioWindow.document.write(`<li>${pair[0].nome} vs ${pair[1].nome}</li>`);
            });
            sorteioWindow.document.write('</ul>');
        }
    </script>

</body>
</html>
